name: Soroban Tools e2e

on:
  push:
    branches: [main, release/**]
  pull_request:

concurrency:
  group: ${{ github.workflow }}-${{ github.ref_protected == 'true' && github.sha || github.ref }}
  cancel-in-progress: true

jobs:
  systems-test:
    strategy:
      fail-fast: false
      matrix:
        sys:
            # x64
          - os: ubuntu-latest-16-cores
            # ARM
          - os: ubuntu-jammy-16-cores-arm64
            # Intel
          - os: macos-13
            # ARM
          - os: macos-latest
            # Not supported yet
          # - os: windows-latest-8-cores
    uses: stellar/system-test/.github/workflows/test.yml@b44541213d4b28cdf74bba34d91449ae9cea82cd
    with:
      stellar-cli-ref: ${{ github.ref }}
      test-filter: "^TestDappDevelop$/^.*$"
      runner: ${{ matrix.sys.os }}
